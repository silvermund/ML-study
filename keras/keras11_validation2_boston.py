#보스턴 주택가격을 완성할것

from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import numpy as np
from sklearn import datasets
from sklearn.metrics import r2_score
from sklearn.datasets import load_boston
from sklearn.model_selection import train_test_split

datasets = load_boston()

x = datasets.data
y = datasets.target

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, shuffle=True, random_state=5)

print(x.shape)
print(y.shape)
print(datasets.feature_names) ## ['CRIM' 'ZN' 'INDUS' 'CHAS' 'NOX' 'RM' 'AGE' 'DIS' 'RAD' 'TAX' 'PTRATIO' 'B' 'LSTAT'] 13의 요소
print(datasets.DESCR)


model = Sequential()
model.add(Dense(55, input_dim=13)) #위의 종류만큼 input
model.add(Dense(44))
model.add(Dense(33))
model.add(Dense(22))
model.add(Dense(11))
model.add(Dense(1))

model.compile(loss='mse', optimizer='adam')

model.fit(x_train, y_train, epochs=100, batch_size=1, validation_split=0.3, shuffle=True)

loss = model.evaluate(x, y)
print('loss : ', loss)

y_predict = model.predict(x)
print('x_predict의 예측값 : ', y_predict)

r2 = r2_score(y, y_predict)

print("r2스코어 :", r2)

'''
loss :  31.594804763793945
x_predict의 예측값 :  [[30.074686 ]
 [25.241932 ]
 [30.536917 ]
 [29.798237 ]
 [28.502157 ]
 [27.239185 ]
 [21.550623 ]
 [17.506126 ]
 [ 6.034506 ]
 [17.929373 ]
 [16.384314 ]
 [21.683086 ]
 [16.109955 ]
 [24.150719 ]
 [24.04016  ]
 [23.36103  ]
 [23.256662 ]
 [19.55875  ]
 [16.521683 ]
 [21.550531 ]
 [13.677354 ]
 [21.020561 ]
 [16.994478 ]
 [15.665235 ]
 [18.815844 ]
 [15.771815 ]
 [19.327257 ]
 [16.335205 ]
 [23.371836 ]
 [23.992687 ]
 [11.798748 ]
 [22.436123 ]
 [ 4.6266894]
 [16.031898 ]
 [13.38189  ]
 [23.933298 ]
 [21.26125  ]
 [22.468044 ]
 [20.594273 ]
 [32.825146 ]
 [35.61718  ]
 [24.402115 ]
 [22.3176   ]
 [21.029438 ]
 [21.023218 ]
 [19.400867 ]
 [15.847309 ]
 [15.444592 ]
 [ 3.2333608]
 [15.157493 ]
 [19.175533 ]
 [24.585306 ]
 [26.488373 ]
 [22.31863  ]
 [21.725649 ]
 [34.4109   ]
 [30.96699  ]
 [36.42423  ]
 [25.317722 ]
 [24.296402 ]
 [21.342636 ]
 [22.470848 ]
 [29.267794 ]
 [25.270596 ]
 [26.4971   ]
 [31.371786 ]
 [25.852688 ]
 [21.386724 ]
 [17.083426 ]
 [21.584568 ]
 [22.260738 ]
 [18.860765 ]
 [22.790783 ]
 [20.936201 ]
 [22.362001 ]
 [22.857216 ]
 [22.0921   ]
 [21.524555 ]
 [19.978235 ]
 [21.352211 ]
 [28.666033 ]
 [29.212017 ]
 [26.22499  ]
 [26.102953 ]
 [22.662188 ]
 [26.804533 ]
 [18.615976 ]
 [24.159525 ]
 [31.017157 ]
 [29.312243 ]
 [25.089592 ]
 [26.22785  ]
 [27.938395 ]
 [27.506546 ]
 [26.930357 ]
 [26.253052 ]
 [22.103827 ]
 [33.858395 ]
 [31.0262   ]
 [29.490973 ]
 [26.830448 ]
 [27.9918   ]
 [20.15207  ]
 [22.183973 ]
 [23.588333 ]
 [19.532375 ]
 [17.046772 ]
 [21.50526  ]
 [24.905344 ]
 [20.665846 ]
 [20.332125 ]
 [26.313618 ]
 [19.610937 ]
 [19.314714 ]
 [25.201666 ]
 [18.888464 ]
 [22.55785  ]
 [24.596195 ]
 [17.941196 ]
 [19.463413 ]
 [20.014725 ]
 [21.295895 ]
 [18.38651  ]
 [11.229913 ]
 [18.789686 ]
 [21.234459 ]
 [ 8.673421 ]
 [18.601377 ]
 [22.289825 ]
 [17.225779 ]
 [24.873144 ]
 [24.694902 ]
 [25.761412 ]
 [20.597689 ]
 [16.455542 ]
 [20.356531 ]
 [18.978973 ]
 [23.01523  ]
 [15.246633 ]
 [18.6823   ]
 [12.895636 ]
 [ 0.9848825]
 [12.413377 ]
 [ 9.763609 ]
 [ 5.7124224]
 [ 6.555522 ]
 [15.950945 ]
 [ 5.2989144]
 [ 6.339384 ]
 [13.801188 ]
 [22.60336  ]
 [21.4422   ]
 [23.90447  ]
 [18.295948 ]
 [23.770153 ]
 [19.016422 ]
 [13.777346 ]
 [33.105133 ]
 [29.387526 ]
 [29.925005 ]
 [32.99147  ]
 [36.739243 ]
 [41.069473 ]
 [40.718193 ]
 [23.660902 ]
 [23.567802 ]
 [36.105366 ]
 [19.687525 ]
 [24.107706 ]
 [24.47759  ]
 [19.702072 ]
 [22.998161 ]
 [19.910858 ]
 [26.899342 ]
 [23.871592 ]
 [26.811855 ]
 [21.927698 ]
 [28.26903  ]
 [29.083832 ]
 [30.026007 ]
 [31.245296 ]
 [24.244524 ]
 [33.07564  ]
 [31.117723 ]
 [20.41878  ]
 [20.799347 ]
 [32.006042 ]
 [30.108479 ]
 [30.267462 ]
 [31.867952 ]
 [29.319042 ]
 [30.083466 ]
 [32.522392 ]
 [29.526873 ]
 [30.067158 ]
 [38.182117 ]
 [34.664467 ]
 [29.425144 ]
 [32.43982  ]
 [33.43092  ]
 [33.605007 ]
 [29.755764 ]
 [35.621128 ]
 [39.12095  ]
 [40.299046 ]
 [19.076105 ]
 [21.966835 ]
 [15.314068 ]
 [21.224993 ]
 [14.822504 ]
 [21.195774 ]
 [13.350415 ]
 [19.309427 ]
 [22.159813 ]
 [-1.39324  ]
 [22.474    ]
 [22.60761  ]
 [26.899952 ]
 [21.413937 ]
 [29.135687 ]
 [31.347738 ]
 [18.504536 ]
 [29.99198  ]
 [28.864975 ]
 [35.779667 ]
 [36.64465  ]
 [36.71935  ]
 [30.88494  ]
 [29.931479 ]
 [27.805805 ]
 [22.169966 ]
 [32.192204 ]
 [36.81187  ]
 [34.965862 ]
 [30.013647 ]
 [22.67689  ]
 [29.351406 ]
 [32.223015 ]
 [26.153378 ]
 [27.255487 ]
 [25.039755 ]
 [23.042004 ]
 [23.283766 ]
 [25.895926 ]
 [21.082779 ]
 [15.242116 ]
 [22.697327 ]
 [25.005493 ]
 [23.984823 ]
 [25.494234 ]
 [25.472237 ]
 [26.951153 ]
 [27.646753 ]
 [30.913507 ]
 [28.599163 ]
 [24.61546  ]
 [37.690083 ]
 [38.29965  ]
 [33.378605 ]
 [33.185284 ]
 [30.132923 ]
 [33.555195 ]
 [36.948265 ]
 [29.746708 ]
 [32.255295 ]
 [24.158875 ]
 [24.767078 ]
 [33.32553  ]
 [34.38016  ]
 [23.997313 ]
 [19.74308  ]
 [25.032087 ]
 [27.854944 ]
 [33.950733 ]
 [35.431095 ]
 [33.742794 ]
 [34.97151  ]
 [34.25422  ]
 [28.145958 ]
 [29.496483 ]
 [34.83542  ]
 [29.976027 ]
 [36.790337 ]
 [41.08442  ]
 [30.572952 ]
 [26.26229  ]
 [22.23356  ]
 [27.626116 ]
 [28.462032 ]
 [25.182125 ]
 [35.683277 ]
 [36.110058 ]
 [33.517807 ]
 [20.881    ]
 [20.593365 ]
 [25.097054 ]
 [25.10572  ]
 [15.715489 ]
 [29.616425 ]
 [30.774887 ]
 [32.116096 ]
 [26.012169 ]
 [24.799301 ]
 [29.618277 ]
 [30.76948  ]
 [28.891527 ]
 [34.24997  ]
 [31.772509 ]
 [31.318438 ]
 [24.272125 ]
 [15.876391 ]
 [26.845331 ]
 [23.818886 ]
 [27.26766  ]
 [26.872107 ]
 [21.961123 ]
 [16.210682 ]
 [17.449657 ]
 [23.98196  ]
 [20.326372 ]
 [25.85416  ]
 [26.19567  ]
 [24.226933 ]
 [21.27454  ]
 [25.894997 ]
 [24.795391 ]
 [24.562819 ]
 [18.772924 ]
 [18.676996 ]
 [21.526495 ]
 [20.14728  ]
 [18.856852 ]
 [23.120909 ]
 [25.379122 ]
 [24.37012  ]
 [22.546846 ]
 [21.585754 ]
 [21.701038 ]
 [22.753778 ]
 [22.002895 ]
 [23.33526  ]
 [30.317276 ]
 [23.09632  ]
 [30.968758 ]
 [31.37344  ]
 [19.222746 ]
 [16.847284 ]
 [30.705017 ]
 [31.226894 ]
 [27.796085 ]
 [27.492954 ]
 [28.546227 ]
 [23.836512 ]
 [33.177055 ]
 [25.38473  ]
 [28.094429 ]
 [24.611843 ]
 [29.273922 ]
 [29.665297 ]
 [25.368612 ]
 [30.876717 ]
 [24.426216 ]
 [27.119116 ]
 [26.029264 ]
 [41.444508 ]
 [24.90683  ]
 [21.25703  ]
 [16.06162  ]
 [33.04059  ]
 [39.315243 ]
 [41.113167 ]
 [29.440075 ]
 [31.446648 ]
 [ 2.686168 ]
 [-2.845093 ]
 [27.574697 ]
 [16.225803 ]
 [19.931536 ]
 [15.100646 ]
 [17.340788 ]
 [15.996998 ]
 [18.882477 ]
 [14.860945 ]
 [14.041993 ]
 [ 2.0375395]
 [ 6.569721 ]
 [ 6.9219265]
 [ 3.5889637]
 [ 5.762148 ]
 [17.110178 ]
 [21.288275 ]
 [19.267073 ]
 [11.200607 ]
 [23.853683 ]
 [21.71809  ]
 [23.023607 ]
 [20.896368 ]
 [18.838007 ]
 [ 5.20805  ]
 [ 6.9317694]
 [11.337679 ]
 [19.364151 ]
 [19.606514 ]
 [16.227093 ]
 [ 5.9655285]
 [ 9.967974 ]
 [10.437841 ]
 [24.728321 ]
 [11.025421 ]
 [17.496672 ]
 [17.816387 ]
 [13.373765 ]
 [-4.4352617]
 [12.363746 ]
 [-8.772725 ]
 [ 4.842841 ]
 [ 8.711297 ]
 [ 4.6530037]
 [ 6.248126 ]
 [11.072106 ]
 [23.545538 ]
 [22.027906 ]
 [21.093927 ]
 [ 9.030934 ]
 [12.389188 ]
 [ 7.582286 ]
 [13.662883 ]
 [14.585494 ]
 [12.000132 ]
 [10.47227  ]
 [16.172945 ]
 [15.732719 ]
 [21.261591 ]
 [18.441385 ]
 [18.66161  ]
 [12.36281  ]
 [15.268173 ]
 [ 6.694521 ]
 [-0.7614839]
 [15.250337 ]
 [14.987675 ]
 [20.194881 ]
 [23.32856  ]
 [21.23992  ]
 [12.237294 ]
 [10.335189 ]
 [20.877472 ]
 [22.700909 ]
 [21.228506 ]
 [19.330133 ]
 [16.628283 ]
 [22.336761 ]
 [21.991901 ]
 [25.090538 ]
 [15.242909 ]
 [15.970979 ]
 [13.266604 ]
 [14.071826 ]
 [20.18661  ]
 [23.301085 ]
 [21.468082 ]
 [24.589989 ]
 [24.43165  ]
 [28.91641  ]
 [23.388731 ]
 [19.652445 ]
 [14.857017 ]
 [16.65103  ]
 [17.199774 ]
 [19.615236 ]
 [21.939213 ]
 [25.757769 ]
 [23.827366 ]
 [26.894337 ]
 [18.445013 ]
 [14.055622 ]
 [21.333279 ]
 [11.272154 ]
 [20.75112  ]
 [24.661638 ]
 [25.676374 ]
 [30.432703 ]
 [32.003708 ]
 [23.085543 ]
 [20.548758 ]
 [24.98221  ]
 [22.375158 ]
 [23.501453 ]
 [16.260159 ]
 [10.1392975]
 [ 3.4915106]
 [17.821873 ]
 [21.2377   ]
 [20.546309 ]
 [18.715841 ]
 [13.100246 ]
 [12.299001 ]
 [19.748299 ]
 [21.198235 ]
 [18.659096 ]
 [20.877043 ]
 [25.294424 ]
 [25.46117  ]
 [31.79733  ]
 [30.308887 ]
 [26.609875 ]]
r2스코어 : 0.6257406812778687
'''