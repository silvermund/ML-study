from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import numpy as np
from sklearn import datasets
from sklearn.metrics import r2_score
from sklearn.datasets import load_boston
from sklearn.model_selection import train_test_split


# 완료하시오!!!
# 0709과제

datasets = load_boston()

x = datasets.data
y = datasets.target

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, shuffle=True, random_state=5)

print(x.shape)
print(y.shape)
print(datasets.feature_names) ## ['CRIM' 'ZN' 'INDUS' 'CHAS' 'NOX' 'RM' 'AGE' 'DIS' 'RAD' 'TAX' 'PTRATIO' 'B' 'LSTAT'] 13의 요소
print(datasets.DESCR)


model = Sequential()
model.add(Dense(55, input_dim=13)) #위의 종류만큼 input
model.add(Dense(44))
model.add(Dense(33))
model.add(Dense(22))
model.add(Dense(11))
model.add(Dense(1))

model.compile(loss='mse', optimizer='adam')

model.fit(x, y, epochs=10000, batch_size=1)

loss = model.evaluate(x, y)
print('loss : ', loss)

y_predict = model.predict(x)
print('x_predict의 예측값 : ', y_predict)

r2 = r2_score(y, y_predict)

print("r2스코어 :", r2)


'''
loss :  25.838565826416016
x_predict의 예측값 :  [[ 2.90642700e+01]
 [ 2.45497837e+01]
 [ 2.95348969e+01]
 [ 2.89779148e+01]
 [ 2.81425381e+01]
 [ 2.61297607e+01]
 [ 2.13762894e+01]
 [ 1.78870754e+01]
 [ 9.59266472e+00]
 [ 1.76634331e+01]
 [ 1.72121906e+01]
 [ 2.04569855e+01]
 [ 1.86619053e+01]
 [ 2.24075413e+01]
 [ 2.19738693e+01]
 [ 2.20534077e+01]
 [ 2.29020081e+01]
 [ 1.92699699e+01]
 [ 1.77725430e+01]
 [ 2.08763237e+01]
 [ 1.47388630e+01]
 [ 2.01426258e+01]
 [ 1.78390961e+01]
 [ 1.61655140e+01]
 [ 1.82614803e+01]
 [ 1.56007309e+01]
 [ 1.82267456e+01]
 [ 1.65428810e+01]
 [ 2.18930244e+01]
 [ 2.28843975e+01]
 [ 1.34752941e+01]
 [ 2.06460953e+01]
 [ 9.20363426e+00]
 [ 1.64271946e+01]
 [ 1.47296867e+01]
 [ 2.41090679e+01]
 [ 2.23821945e+01]
 [ 2.34274673e+01]
 [ 2.28094082e+01]
 [ 3.15274658e+01]
 [ 3.41038628e+01]
 [ 2.63916302e+01]
 [ 2.40617924e+01]
 [ 2.33743439e+01]
 [ 2.21228409e+01]
 [ 2.12271881e+01]
 [ 1.91623878e+01]
 [ 1.72228737e+01]
 [ 8.18928146e+00]
 [ 1.68282394e+01]
 [ 2.02066879e+01]
 [ 2.33063507e+01]
 [ 2.63725452e+01]
 [ 2.29763432e+01]
 [ 1.75557690e+01]
 [ 3.17934761e+01]
 [ 2.62044678e+01]
 [ 3.23258133e+01]
 [ 2.32902908e+01]
 [ 2.24924355e+01]
 [ 1.95482941e+01]
 [ 1.99970837e+01]
 [ 2.55603313e+01]
 [ 2.36510372e+01]
 [ 2.44603043e+01]
 [ 2.86903515e+01]
 [ 2.40681038e+01]
 [ 2.05078506e+01]
 [ 1.69151363e+01]
 [ 2.02944565e+01]
 [ 2.32361355e+01]
 [ 2.00521145e+01]
 [ 2.30452404e+01]
 [ 2.21218929e+01]
 [ 2.26982441e+01]
 [ 2.15985489e+01]
 [ 2.05138187e+01]
 [ 2.08550892e+01]
 [ 1.90692558e+01]
 [ 2.03576832e+01]
 [ 2.78761349e+01]
 [ 2.69386082e+01]
 [ 2.57465324e+01]
 [ 2.49986553e+01]
 [ 2.40238132e+01]
 [ 2.69825802e+01]
 [ 2.12751904e+01]
 [ 2.50840797e+01]
 [ 2.99179344e+01]
 [ 2.96543694e+01]
 [ 2.61489811e+01]
 [ 2.66190014e+01]
 [ 2.72680607e+01]
 [ 2.74041920e+01]
 [ 2.56802788e+01]
 [ 2.68552818e+01]
 [ 2.33764191e+01]
 [ 3.34440956e+01]
 [ 3.24547844e+01]
 [ 3.01323452e+01]
 [ 2.51871891e+01]
 [ 2.62023945e+01]
 [ 1.87113457e+01]
 [ 2.12043839e+01]
 [ 2.22724152e+01]
 [ 1.92972622e+01]
 [ 1.77839546e+01]
 [ 2.12516613e+01]
 [ 2.33487110e+01]
 [ 2.03846207e+01]
 [ 2.10710659e+01]
 [ 2.48212013e+01]
 [ 1.93145695e+01]
 [ 1.91776447e+01]
 [ 2.36431084e+01]
 [ 1.86797886e+01]
 [ 2.18768444e+01]
 [ 2.26151600e+01]
 [ 1.84136143e+01]
 [ 1.94553566e+01]
 [ 2.18432674e+01]
 [ 2.24012985e+01]
 [ 2.03287964e+01]
 [ 1.56160488e+01]
 [ 2.04410477e+01]
 [ 2.23987827e+01]
 [ 1.37687626e+01]
 [ 1.68377113e+01]
 [ 2.01778622e+01]
 [ 1.57889900e+01]
 [ 2.15942078e+01]
 [ 2.11906929e+01]
 [ 2.18392029e+01]
 [ 1.77597389e+01]
 [ 1.43937435e+01]
 [ 1.85898952e+01]
 [ 1.73111897e+01]
 [ 2.06363773e+01]
 [ 1.49983940e+01]
 [ 1.76235237e+01]
 [ 1.41536579e+01]
 [ 4.89010239e+00]
 [ 1.57216530e+01]
 [ 1.31748104e+01]
 [ 9.93723106e+00]
 [ 1.10267105e+01]
 [ 1.60981903e+01]
 [ 9.67075634e+00]
 [ 1.05386047e+01]
 [ 1.57761497e+01]
 [ 2.20884514e+01]
 [ 2.00690098e+01]
 [ 2.22861710e+01]
 [ 1.81366367e+01]
 [ 2.33965626e+01]
 [ 1.95856457e+01]
 [ 1.37870979e+01]
 [ 2.96013794e+01]
 [ 2.59167385e+01]
 [ 2.70383739e+01]
 [ 2.94606609e+01]
 [ 3.28785744e+01]
 [ 3.67472420e+01]
 [ 3.74200096e+01]
 [ 2.19245949e+01]
 [ 2.14846001e+01]
 [ 3.28744049e+01]
 [ 1.89825935e+01]
 [ 2.25083008e+01]
 [ 2.29333496e+01]
 [ 1.88749638e+01]
 [ 2.11612797e+01]
 [ 2.14594555e+01]
 [ 2.72010918e+01]
 [ 2.48765450e+01]
 [ 2.84818172e+01]
 [ 2.38872375e+01]
 [ 2.77198067e+01]
 [ 2.93015614e+01]
 [ 3.17879467e+01]
 [ 3.30350380e+01]
 [ 2.69681988e+01]
 [ 3.30305557e+01]
 [ 3.07152958e+01]
 [ 2.25935631e+01]
 [ 2.40413227e+01]
 [ 3.41404686e+01]
 [ 2.93119488e+01]
 [ 2.87800064e+01]
 [ 3.05029678e+01]
 [ 2.75049744e+01]
 [ 2.74517307e+01]
 [ 2.97795353e+01]
 [ 2.95840397e+01]
 [ 2.92768917e+01]
 [ 3.73615990e+01]
 [ 3.20178032e+01]
 [ 2.81587143e+01]
 [ 3.04485569e+01]
 [ 2.93336258e+01]
 [ 2.96591625e+01]
 [ 2.71891479e+01]
 [ 3.37307739e+01]
 [ 3.85640678e+01]
 [ 3.96029510e+01]
 [ 2.16269169e+01]
 [ 2.28545914e+01]
 [ 1.72231216e+01]
 [ 2.27068005e+01]
 [ 1.67256374e+01]
 [ 2.18770313e+01]
 [ 1.63878746e+01]
 [ 2.17774944e+01]
 [ 2.39288387e+01]
 [ 8.44076538e+00]
 [ 2.35727596e+01]
 [ 2.46485310e+01]
 [ 2.64689522e+01]
 [ 2.30424709e+01]
 [ 2.81887913e+01]
 [ 3.11349201e+01]
 [ 2.16741142e+01]
 [ 3.01711750e+01]
 [ 2.81263847e+01]
 [ 3.52445793e+01]
 [ 3.63098946e+01]
 [ 3.50141449e+01]
 [ 3.01562481e+01]
 [ 3.21427956e+01]
 [ 2.89926128e+01]
 [ 2.29473877e+01]
 [ 3.11092834e+01]
 [ 3.54226456e+01]
 [ 3.43290749e+01]
 [ 2.98508453e+01]
 [ 2.36351070e+01]
 [ 2.87537289e+01]
 [ 3.09131355e+01]
 [ 2.61050224e+01]
 [ 2.62919445e+01]
 [ 2.48933716e+01]
 [ 2.21326790e+01]
 [ 2.23940315e+01]
 [ 2.54587421e+01]
 [ 1.74872341e+01]
 [ 1.41089458e+01]
 [ 2.05361271e+01]
 [ 2.07584820e+01]
 [ 2.15029984e+01]
 [ 2.39282494e+01]
 [ 2.40506554e+01]
 [ 2.49298077e+01]
 [ 2.50936527e+01]
 [ 2.90899372e+01]
 [ 2.41818638e+01]
 [ 2.17320766e+01]
 [ 3.53407440e+01]
 [ 3.96434441e+01]
 [ 3.40021782e+01]
 [ 3.31038132e+01]
 [ 3.22015800e+01]
 [ 3.45531197e+01]
 [ 3.78112984e+01]
 [ 3.17816982e+01]
 [ 3.33593292e+01]
 [ 2.66558342e+01]
 [ 2.83932152e+01]
 [ 3.59850388e+01]
 [ 3.55334129e+01]
 [ 2.55154343e+01]
 [ 2.20298634e+01]
 [ 2.67531681e+01]
 [ 2.80784016e+01]
 [ 3.43568802e+01]
 [ 3.47312851e+01]
 [ 3.24800491e+01]
 [ 3.41292496e+01]
 [ 3.36306801e+01]
 [ 2.88266201e+01]
 [ 3.14883823e+01]
 [ 3.48731537e+01]
 [ 3.09724884e+01]
 [ 3.67235909e+01]
 [ 4.08773384e+01]
 [ 2.94580173e+01]
 [ 2.51145344e+01]
 [ 2.10218449e+01]
 [ 2.56495399e+01]
 [ 2.59017410e+01]
 [ 2.47666988e+01]
 [ 3.36314507e+01]
 [ 3.43327789e+01]
 [ 3.20608940e+01]
 [ 2.21263027e+01]
 [ 2.10484886e+01]
 [ 2.48629875e+01]
 [ 2.40568161e+01]
 [ 1.65507278e+01]
 [ 2.66067009e+01]
 [ 2.86955662e+01]
 [ 2.82572765e+01]
 [ 2.58588333e+01]
 [ 2.55537014e+01]
 [ 2.93666363e+01]
 [ 3.22451973e+01]
 [ 3.01264572e+01]
 [ 3.45050316e+01]
 [ 3.20801430e+01]
 [ 2.88251400e+01]
 [ 2.37460632e+01]
 [ 1.82995434e+01]
 [ 2.66558056e+01]
 [ 2.33330574e+01]
 [ 2.57483978e+01]
 [ 2.55610085e+01]
 [ 2.12199783e+01]
 [ 1.76772480e+01]
 [ 1.86149464e+01]
 [ 2.41242886e+01]
 [ 2.13199787e+01]
 [ 2.53163700e+01]
 [ 2.53958263e+01]
 [ 2.36472950e+01]
 [ 2.05299759e+01]
 [ 2.55499859e+01]
 [ 2.51015949e+01]
 [ 2.43631401e+01]
 [ 1.99359837e+01]
 [ 1.89575520e+01]
 [ 2.16649818e+01]
 [ 1.95226955e+01]
 [ 1.91825256e+01]
 [ 2.23385105e+01]
 [ 2.47062073e+01]
 [ 2.40494652e+01]
 [ 2.30189953e+01]
 [ 2.23882847e+01]
 [ 2.17924004e+01]
 [ 2.39959354e+01]
 [ 2.31723862e+01]
 [ 2.35895100e+01]
 [ 2.86658726e+01]
 [ 2.11232357e+01]
 [ 2.77286968e+01]
 [ 2.84920292e+01]
 [ 1.72188091e+01]
 [ 1.53277531e+01]
 [ 2.62199879e+01]
 [ 2.81205235e+01]
 [ 2.41754608e+01]
 [ 2.30520363e+01]
 [ 2.20495129e+01]
 [ 1.86878071e+01]
 [ 2.77836399e+01]
 [ 1.96903114e+01]
 [ 2.18371525e+01]
 [ 2.07501297e+01]
 [ 2.40625000e+01]
 [ 2.39554119e+01]
 [ 2.05727825e+01]
 [ 2.41625919e+01]
 [ 1.98602028e+01]
 [ 2.03814754e+01]
 [ 2.14530163e+01]
 [ 3.57843056e+01]
 [ 1.67577171e+01]
 [ 1.61645222e+01]
 [ 9.93711472e+00]
 [ 2.38985920e+01]
 [ 3.13427181e+01]
 [ 3.31305962e+01]
 [ 2.34530716e+01]
 [ 2.53796520e+01]
 [ 4.79060411e+00]
 [-4.46939468e-03]
 [ 2.37564831e+01]
 [ 1.56878986e+01]
 [ 1.83815937e+01]
 [ 1.44091339e+01]
 [ 1.56090012e+01]
 [ 1.41891003e+01]
 [ 1.70537930e+01]
 [ 1.31348610e+01]
 [ 1.26647091e+01]
 [ 2.83320594e+00]
 [ 7.50454760e+00]
 [ 6.49971437e+00]
 [ 5.24892902e+00]
 [ 6.16449070e+00]
 [ 1.42790375e+01]
 [ 1.73122482e+01]
 [ 1.67593594e+01]
 [ 9.96732903e+00]
 [ 1.98434811e+01]
 [ 1.78602333e+01]
 [ 1.95721378e+01]
 [ 1.83605137e+01]
 [ 1.59621983e+01]
 [ 6.22002077e+00]
 [ 9.02566242e+00]
 [ 1.11546421e+01]
 [ 1.70366173e+01]
 [ 1.72480316e+01]
 [ 1.33171272e+01]
 [ 6.72755766e+00]
 [ 8.74405861e+00]
 [ 8.11588669e+00]
 [ 1.92522163e+01]
 [ 1.05968609e+01]
 [ 1.55463428e+01]
 [ 1.22470131e+01]
 [ 1.18789005e+01]
 [-2.52787018e+00]
 [ 9.47099304e+00]
 [-5.89143324e+00]
 [ 5.81959009e+00]
 [ 9.22719765e+00]
 [ 4.79295826e+00]
 [ 4.46063900e+00]
 [ 1.13491764e+01]
 [ 1.92362843e+01]
 [ 1.79238529e+01]
 [ 1.66630058e+01]
 [ 8.41683769e+00]
 [ 1.00815220e+01]
 [ 6.77974415e+00]
 [ 1.16828766e+01]
 [ 1.16475582e+01]
 [ 1.11932335e+01]
 [ 9.71877480e+00]
 [ 1.35906277e+01]
 [ 1.37091637e+01]
 [ 1.72630463e+01]
 [ 1.50940495e+01]
 [ 1.45271378e+01]
 [ 1.14112797e+01]
 [ 1.26063595e+01]
 [ 6.50552273e+00]
 [ 2.27944016e+00]
 [ 1.35233078e+01]
 [ 1.32799454e+01]
 [ 1.74387207e+01]
 [ 1.92523346e+01]
 [ 1.81933537e+01]
 [ 1.09239693e+01]
 [ 9.64944649e+00]
 [ 1.75311260e+01]
 [ 1.87070618e+01]
 [ 1.76222134e+01]
 [ 1.64146328e+01]
 [ 1.37254868e+01]
 [ 1.88531284e+01]
 [ 1.84490185e+01]
 [ 2.16080189e+01]
 [ 1.26023769e+01]
 [ 1.33907547e+01]
 [ 1.05106468e+01]
 [ 1.09021816e+01]
 [ 1.65888672e+01]
 [ 1.89194736e+01]
 [ 1.79357128e+01]
 [ 2.02207832e+01]
 [ 2.00156212e+01]
 [ 2.28748989e+01]
 [ 1.95048256e+01]
 [ 1.67267056e+01]
 [ 1.14149475e+01]
 [ 1.41408730e+01]
 [ 1.46878090e+01]
 [ 1.65988503e+01]
 [ 1.79886951e+01]
 [ 2.02160950e+01]
 [ 1.99583645e+01]
 [ 2.30836506e+01]
 [ 1.44794941e+01]
 [ 1.27146759e+01]
 [ 1.83429623e+01]
 [ 9.78544426e+00]
 [ 1.73105717e+01]
 [ 2.01741314e+01]
 [ 2.06785393e+01]
 [ 2.41739635e+01]
 [ 2.55125465e+01]
 [ 1.86116543e+01]
 [ 1.73303528e+01]
 [ 2.03260441e+01]
 [ 1.78589973e+01]
 [ 1.93606625e+01]
 [ 1.10411549e+01]
 [ 6.74899721e+00]
 [ 1.91402864e+00]
 [ 1.25674286e+01]
 [ 1.50259266e+01]
 [ 2.10782299e+01]
 [ 2.05948734e+01]
 [ 1.67614784e+01]
 [ 1.45253792e+01]
 [ 1.98098831e+01]
 [ 2.15898590e+01]
 [ 1.90774708e+01]
 [ 2.08973141e+01]
 [ 2.55018349e+01]
 [ 2.48447285e+01]
 [ 2.97664242e+01]
 [ 2.84208050e+01]
 [ 2.51417942e+01]]
r2스코어 : 0.6939267515872445
'''