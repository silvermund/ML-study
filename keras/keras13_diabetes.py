from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import numpy as np
import pandas as pd
from sklearn.datasets import load_diabetes
from sklearn.metrics import r2_score
from sklearn.model_selection import train_test_split

datasets = load_diabetes()

x = datasets.data
y = datasets.target

print(x.shape, y.shape) #(442,10) (442,)

print(datasets.feature_names) #['age', 'sex', 'bmi', 'bp', 's1', 's2', 's3', 's4', 's5', 's6']

print(datasets.DESCR)

print(y[:30])
print(np.min(y), np.max(y))

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, shuffle=True, random_state=5)

#2. 모델구성
model = Sequential()
model.add(Dense(5, input_dim=10)) #위의 종류만큼 input
model.add(Dense(4))
model.add(Dense(3))
model.add(Dense(2))
model.add(Dense(1))

#3. 컴파일, 훈련

model.compile(loss='mse', optimizer='adam')

model.fit(x_train, y_train, epochs=100, batch_size=1, validation_split=0.3, shuffle=True)

#4. 평가, 예측
# mse, R2
loss = model.evaluate(x, y)
print('loss : ', loss)

y_predict = model.predict(x)
print('x_predict의 예측값 : ', y_predict)

r2 = r2_score(y, y_predict)

print("r2스코어 :", r2)

'''
loss :  2907.471435546875
x_predict의 예측값 :  [[196.17317 ]
 [ 74.9945  ]
 [166.50073 ]
 [166.86519 ]
 [129.74854 ]
 [106.72902 ]
 [ 82.43075 ]
 [130.70164 ]
 [159.02676 ]
 [210.7801  ]
 [ 99.050804]
 [110.248665]
 [115.82921 ]
 [158.007   ]
 [104.163025]
 [179.33101 ]
 [205.30104 ]
 [179.21782 ]
 [145.84012 ]
 [124.689995]
 [116.79263 ]
 [ 96.86906 ]
 [126.4401  ]
 [260.55762 ]
 [165.54767 ]
 [145.64146 ]
 [ 94.7971  ]
 [175.70866 ]
 [123.380165]
 [169.2553  ]
 [163.50562 ]
 [ 71.09865 ]
 [245.66148 ]
 [100.12939 ]
 [ 79.8406  ]
 [ 84.70571 ]
 [201.20015 ]
 [151.38316 ]
 [243.09895 ]
 [136.4843  ]
 [156.0994  ]
 [ 75.28144 ]
 [142.1175  ]
 [ 83.43184 ]
 [210.27419 ]
 [122.43961 ]
 [139.40137 ]
 [104.60647 ]
 [ 79.76812 ]
 [182.50108 ]
 [152.28432 ]
 [160.03096 ]
 [140.83504 ]
 [158.62141 ]
 [147.98024 ]
 [ 79.412285]
 [200.845   ]
 [ 76.728325]
 [ 92.29331 ]
 [134.48903 ]
 [115.80863 ]
 [169.05891 ]
 [ 74.65082 ]
 [108.79624 ]
 [105.496284]
 [181.51576 ]
 [142.4326  ]
 [122.777374]
 [108.838165]
 [118.26672 ]
 [ 79.49525 ]
 [232.11378 ]
 [149.82295 ]
 [126.163025]
 [150.75928 ]
 [125.12806 ]
 [180.28728 ]
 [ 89.33082 ]
 [152.72398 ]
 [104.9486  ]
 [173.11986 ]
 [121.58762 ]
 [ 76.487885]
 [148.59181 ]
 [ 63.06431 ]
 [170.36314 ]
 [ 58.257996]
 [150.96678 ]
 [ 82.03583 ]
 [107.26832 ]
 [ 86.463   ]
 [188.63716 ]
 [185.07185 ]
 [ 66.68212 ]
 [113.180855]
 [121.56042 ]
 [196.91975 ]
 [215.31418 ]
 [123.61475 ]
 [136.1343  ]
 [169.70761 ]
 [107.08012 ]
 [158.24142 ]
 [162.16862 ]
 [160.87251 ]
 [110.852   ]
 [ 80.82528 ]
 [161.71587 ]
 [214.51018 ]
 [142.2282  ]
 [ 54.717392]
 [125.10236 ]
 [158.8008  ]
 [201.4842  ]
 [288.72864 ]
 [190.1722  ]
 [206.21889 ]
 [227.12645 ]
 [165.40746 ]
 [140.98326 ]
 [156.83307 ]
 [192.36739 ]
 [216.53685 ]
 [183.1609  ]
 [164.46255 ]
 [180.42116 ]
 [ 72.00844 ]
 [109.832054]
 [ 97.60456 ]
 [202.58325 ]
 [240.72583 ]
 [ 79.677345]
 [118.16148 ]
 [ 71.8382  ]
 [148.25467 ]
 [226.47737 ]
 [ 65.01355 ]
 [225.62111 ]
 [242.84404 ]
 [240.49532 ]
 [154.4712  ]
 [223.86668 ]
 [171.31386 ]
 [124.72995 ]
 [176.18152 ]
 [237.94466 ]
 [190.21413 ]
 [228.01602 ]
 [125.38276 ]
 [170.2643  ]
 [204.59009 ]
 [140.88751 ]
 [195.33282 ]
 [121.54003 ]
 [148.93513 ]
 [204.84065 ]
 [143.356   ]
 [125.04175 ]
 [ 90.23763 ]
 [230.07811 ]
 [ 86.458626]
 [241.56114 ]
 [146.66055 ]
 [195.22066 ]
 [139.18825 ]
 [ 79.55302 ]
 [ 65.586815]
 [254.93764 ]
 [223.22768 ]
 [233.46294 ]
 [ 60.8222  ]
 [ 89.3662  ]
 [218.98814 ]
 [ 92.17848 ]
 [150.85074 ]
 [116.121635]
 [156.31114 ]
 [215.88652 ]
 [106.476364]
 [165.49251 ]
 [174.08292 ]
 [ 95.685585]
 [171.84352 ]
 [149.94498 ]
 [192.73619 ]
 [181.54005 ]
 [197.36919 ]
 [ 74.62406 ]
 [159.45065 ]
 [114.07354 ]
 [185.5482  ]
 [117.96708 ]
 [ 96.2414  ]
 [144.12207 ]
 [148.08762 ]
 [169.33594 ]
 [104.9432  ]
 [181.43642 ]
 [152.88815 ]
 [175.34482 ]
 [100.13561 ]
 [ 76.45932 ]
 [173.30319 ]
 [194.52888 ]
 [165.16614 ]
 [219.87758 ]
 [160.14809 ]
 [207.79384 ]
 [217.03358 ]
 [162.61403 ]
 [135.24004 ]
 [170.72763 ]
 [152.05019 ]
 [ 99.92337 ]
 [ 93.25583 ]
 [250.28609 ]
 [215.6401  ]
 [215.79503 ]
 [130.34099 ]
 [137.07916 ]
 [ 65.97691 ]
 [140.86237 ]
 [146.75478 ]
 [123.12556 ]
 [ 78.478195]
 [216.84877 ]
 [ 85.37594 ]
 [103.70907 ]
 [122.1914  ]
 [103.4508  ]
 [183.42418 ]
 [154.43666 ]
 [157.3083  ]
 [138.93849 ]
 [222.76042 ]
 [163.35333 ]
 [187.10472 ]
 [ 69.4913  ]
 [176.51343 ]
 [181.44936 ]
 [224.25871 ]
 [122.540276]
 [ 93.97639 ]
 [100.37002 ]
 [142.60556 ]
 [101.397934]
 [123.99196 ]
 [ 83.97433 ]
 [241.00026 ]
 [244.22638 ]
 [252.71846 ]
 [275.15796 ]
 [182.78072 ]
 [199.4526  ]
 [258.7796  ]
 [113.94457 ]
 [261.8588  ]
 [101.846405]
 [115.74474 ]
 [141.74045 ]
 [ 67.30279 ]
 [121.86336 ]
 [258.33603 ]
 [ 55.599052]
 [128.59192 ]
 [129.17598 ]
 [ 47.170715]
 [141.3755  ]
 [235.07158 ]
 [ 90.52984 ]
 [182.30911 ]
 [158.11632 ]
 [141.1852  ]
 [195.68602 ]
 [169.0639  ]
 [151.74806 ]
 [197.18382 ]
 [109.483574]
 [107.70075 ]
 [114.00881 ]
 [162.15504 ]
 [ 93.23156 ]
 [145.5049  ]
 [ 89.57336 ]
 [148.70123 ]
 [192.08002 ]
 [ 72.909874]
 [155.58339 ]
 [ 91.80651 ]
 [195.87535 ]
 [213.71962 ]
 [202.96082 ]
 [ 93.616234]
 [192.67162 ]
 [ 93.25759 ]
 [154.19893 ]
 [ 78.46021 ]
 [105.509926]
 [100.259705]
 [119.47704 ]
 [212.06151 ]
 [127.615746]
 [203.27689 ]
 [227.47508 ]
 [129.65396 ]
 [129.42123 ]
 [127.849   ]
 [142.77391 ]
 [ 87.38676 ]
 [144.96046 ]
 [203.58197 ]
 [171.53453 ]
 [128.23805 ]
 [207.42363 ]
 [173.94621 ]
 [114.06542 ]
 [191.28568 ]
 [172.67929 ]
 [157.49364 ]
 [179.39314 ]
 [194.74495 ]
 [276.25195 ]
 [281.34338 ]
 [222.43565 ]
 [207.44664 ]
 [220.41513 ]
 [148.70393 ]
 [221.18199 ]
 [185.3199  ]
 [100.88674 ]
 [176.35585 ]
 [105.20659 ]
 [280.17618 ]
 [173.22345 ]
 [ 83.71678 ]
 [ 91.18076 ]
 [251.76775 ]
 [166.27943 ]
 [128.43915 ]
 [149.82738 ]
 [171.06445 ]
 [182.27771 ]
 [162.8455  ]
 [164.2512  ]
 [151.88716 ]
 [125.6032  ]
 [187.52718 ]
 [ 99.84457 ]
 [125.56722 ]
 [ 92.8861  ]
 [244.14317 ]
 [ 88.9609  ]
 [ 51.805042]
 [178.3701  ]
 [203.10228 ]
 [134.13618 ]
 [ 97.404495]
 [197.8532  ]
 [ 61.937977]
 [167.38478 ]
 [188.53122 ]
 [121.61103 ]
 [226.39085 ]
 [156.1403  ]
 [153.63805 ]
 [155.61703 ]
 [255.10306 ]
 [256.54807 ]
 [195.05457 ]
 [180.71315 ]
 [ 64.9042  ]
 [201.22734 ]
 [111.93545 ]
 [141.57019 ]
 [123.85746 ]
 [174.06087 ]
 [219.21326 ]
 [165.91487 ]
 [158.98598 ]
 [126.282425]
 [172.38667 ]
 [ 74.03775 ]
 [242.97433 ]
 [112.001274]
 [119.194786]
 [131.84172 ]
 [108.833855]
 [108.45701 ]
 [154.98787 ]
 [ 81.40455 ]
 [254.61856 ]
 [ 62.342873]
 [107.234   ]
 [105.44175 ]
 [262.76776 ]
 [165.44983 ]
 [ 74.67541 ]
 [169.0791  ]
 [172.93184 ]
 [183.81595 ]
 [183.2347  ]
 [ 86.466995]
 [136.52708 ]
 [246.55058 ]
 [197.43645 ]
 [262.37625 ]
 [ 57.214275]
 [180.18416 ]
 [194.67561 ]
 [175.00264 ]
 [159.56303 ]
 [151.41045 ]
 [225.5688  ]
 [128.64241 ]
 [167.90504 ]
 [169.78403 ]
 [227.58759 ]
 [158.28935 ]
 [110.98474 ]
 [ 84.30154 ]
 [140.56017 ]
 [186.75783 ]
 [207.77988 ]
 [149.93504 ]
 [164.44691 ]
 [105.0837  ]
 [160.09724 ]
 [128.3741  ]
 [252.16295 ]
 [110.14567 ]
 [117.84849 ]
 [113.23412 ]
 [217.90884 ]
 [ 70.01916 ]
 [136.94276 ]
 [123.05939 ]
 [ 59.349724]
 [185.92398 ]
 [110.758675]
 [121.38189 ]
 [209.37462 ]
 [ 57.892235]]
r2스코어 : 0.509691728452629
'''